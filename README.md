
# –î–∏–∑–∞–π–Ω –º–æ–ª–µ–∫—É–ª –¥–ª—è –ª–µ—á–µ–Ω–∏—è –±–æ–ª–µ–∑–Ω–∏ –ê–ª—å—Ü–≥–µ–π–º–µ—Ä–∞

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ –¥–∏–∑–∞–π–Ω—É –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö –º–æ–ª–µ–∫—É–ª, –Ω–∞—Ü–µ–ª–µ–Ω–Ω—ã—Ö –Ω–∞ **–≥–ª–∏–∫–æ–Ω–µ–≥—Å–∏–Ω—Ç–∞–∑–Ω—É—é –∫–∏–Ω–∞–∑—É-3 –±–µ—Ç–∞ (Glycogen synthase kinase-3 beta, GSK-3Œ≤)** –¥–ª—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ª–µ—á–µ–Ω–∏—è **–±–æ–ª–µ–∑–Ω–∏ –ê–ª—å—Ü–≥–µ–π–º–µ—Ä–∞**.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ agd/
‚îÇ   ‚îú‚îÄ‚îÄ filter/                 # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –æ—Ü–µ–Ω–∫–∞ –º–æ–ª–µ–∫—É–ª
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ molecule_evaluator.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sa_scorer.py
‚îÇ   ‚îú‚îÄ‚îÄ loader/                 # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö ChEMBL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ load_chembl.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ clean_chembl.py
‚îÇ   ‚îú‚îÄ‚îÄ predictor/              # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –º–æ–¥–µ–ª–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ feature_extraction.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pipeline.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ predict.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ processing.py
‚îú‚îÄ‚îÄ notebooks/                  # Jupyter –Ω–æ—É—Ç–±—É–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
‚îú‚îÄ‚îÄ resources/                  # –†–µ—Å—É—Ä—Å—ã –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ test/                       # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ scripts/                   # –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è REINVENT4
‚îî‚îÄ‚îÄ README.md
```

### 1. üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install -r requirements.txt
```

### 2. üì• –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ChEMBL

```python
from agd.loader.load_chembl import parse_activities
from agd.loader.clean_chembl import clean_data

parse_activities("CHEMBL262")      # –ó–∞–≥—Ä—É–∑–∫–∞
clean_data("CHEMBL262")         # –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
```

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

```python
from agd.predictor.feature_extraction import get_features_dataset

df = get_features_dataset(
    target_id="CHEMBL262",
    descriptors=["rdkit", "mordred"],
    fingerprints={
        "morgan": {
            "params": {"radius": 2, "fpSize": 1024}
        }
    }
)
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –∏ —Ñ–∏–Ω–≥–µ—Ä–ø—Ä–∏–Ω—Ç—ã:
- `rdkit`: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã RDKit
- `mordred`: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã Mordred
- `morgan`: —Ñ–∏–Ω–≥–µ—Ä–ø—Ä–∏–Ω—Ç—ã Morgan (—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `radius` –∏ `fpSize`)

### 4. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–®–∞–≥–∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–ø–∏—Å–∞–Ω—ã –≤ `notebooks/training_pipeline.ipynb`. –í `resources/` —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å `catboost_rdkit_morgan.pkl` (RDKit –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã + Morgan —Ñ–∏–Ω–≥–µ—Ä–ø—Ä–∏–Ω—Ç—ã), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è PiC50 (R2 = 0.7236).


### 5. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–æ–ª–µ–∫—É–ª

```python
from agd.predictor.predict import predict_rdkit_morgan

smiles = "COc1ccc(CNC(=O)Nc2ncc([N+](=O)[O-])s2)cc1"
predict_rdkit_morgan(smiles=smiles, model_name="catboost")
```

### 6. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –º–æ–ª–µ–∫—É–ª —Å –ø–æ–º–æ—â—å—é [REINVENT](https://github.com/MolecularAI/REINVENT4)
–ù–∞ –æ—Å–Ω–æ–≤–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ `catboost_rdkit_morgan.pkl` –∏ SMILES-—Å—Ç—Ä–æ–∫ –∏–∑ `resources/` —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –Ω–æ–≤—ã–µ –º–æ–ª–µ–∫—É–ª—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –º–æ–¥–µ–ª–∏ REINVENT.
1. –°–æ–∑–¥–∞–Ω `scripts/reinvent_predict.py`, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å REINVENT.
2. –í –ø—Ä–æ—Ü–µ—Å—Å–µ RL-–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ REINVENT4 —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –∫–∞–∫ `ExternalProcess` –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–ª–µ–∫—É–ª.
3. –ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –º–æ–ª–µ–∫—É–ª —Å —É—á—ë—Ç–æ–º —Ç–∞—Ä–≥–µ—Ç–∞ –∏ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–æ–ª–µ–∫—É–ª: https://drive.google.com/drive/folders/17QwYozkSWYgUe1wXoEDbZXLi7SBCenti?usp=drive_link

### 7. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–ª–µ–∫—É–ª

  * **`pIC50` (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å) \>= 6.7**: –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–∏–≤ GSK-3Œ≤
  * **`qed` (Quantitative Estimation of Drug-likeness) \> 0.7**: –≤—ã—Å–æ–∫–∞—è —Å—Ç–µ–ø–µ–Ω—å –ª–µ–∫–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–¥–æ–±–∏—è
  * **`sa` (Synthetic Accessibility) –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 2 –¥–æ 6**: —É–º–µ—Ä–µ–Ω–Ω–∞—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
  * **`bbb` (Blood-Brain Barrier permeability)**: —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø—Ä–æ–Ω–∏–∫–∞—Ç—å —á–µ—Ä–µ–∑ –≥–µ–º–∞—Ç–æ—ç–Ω—Ü–µ—Ñ–∞–ª–∏—á–µ—Å–∫–∏–π –±–∞—Ä—å–µ—Ä
  * **`tox_free`**: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏
  * **`lip` (Lipinski's Rule of Five violations) \<= 1**: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º –õ–∏–ø–∏–Ω—Å–∫–æ–≥–æ
  * **`carc`**: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç–∏

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ç–æ–ª—å–∫–æ **–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ** –º–æ–ª–µ–∫—É–ª—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–Ω—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.


## –ö–æ–Ω—Ç–∞–∫—Ç—ã

* @SireX2106
* @philareth
* @sunraysu
* @matveiss
* @readKavafisListenFredAgain

