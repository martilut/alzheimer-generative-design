
# Проект по дизайну и генерации молекул для лечения болезни Альцгеймера

Этот репозиторий содержит код для рабочего процесса по дизайну и генерации новых молекул, нацеленных на **гликонегсинтазную киназу-3 бета (Glycogen synthase kinase-3 beta, GSK-3β)** для потенциального лечения **болезни Альцгеймера**.

## Описание проекта

Проект состоит из нескольких ключевых этапов:

### 1\. Выбор мишени и подготовка данных

В качестве мишени для лечения болезни Альцгеймера была выбрана **гликонегсинтазная киназа-3 бета (Glycogen synthase kinase-3 beta, GSK-3β)**.
**Glycogen synthase kinase-3 beta (GSK-3β)** – это серин-треонинкиназа, фермент, который участвует в образовании амилоидного β-пептида из его предшественника и ингибирует тау-белок, что является одним из механизмов патогенеза **болезни Альцгеймера (БА)**. В здоровом состоянии тау-белки функционируют как белки, ассоциированные с микротрубочками, и способствуют поддержанию структурной стабильности клеток. Однако гиперфосфорилированные тау-белки отделяются от микротрубочек и накапливаются в мозге, образуя нейрофибриллярные клубки. Есть множество исследований о том, что **ингибирование** этого белка ведёт к уменьшению проявления болезни Альцгеймера и предотвращению гибели нейронов *in vivo*, что делает мишень **перспективной для терапевтического воздействия** на болезнь Альцгеймера.

Данные о соединениях-лигандах для этой мишени были получены из базы данных **ChEMBL**.
После загрузки данных были выполнены следующие шаги предобработки:

  * **Удаление пропущенных значений (NaN)**: Записи с отсутствующими критическими значениями были удалены для обеспечения целостности данных.
  * **Удаление дубликатов**: Идентичные записи были удалены, чтобы предотвратить смещение при обучении модели.

В итоге осталось 3635 молекул.

### 2\. Расчет дескрипторов и отпечатков молекул

Для каждого соединения были рассчитаны различные молекулярные дескрипторы и отпечатки:

  * **Mordred Descriptors**: Выбраны из-за их **широкого спектра** дескрипторов (более 1800), охватывающих различные аспекты молекулярной структуры, такие как топологические, электронные, физико-химические свойства. Это позволяет получить **всестороннее представление** о молекуле.
  * **Morgan Fingerprints**: Выбраны за их **эффективность** в представлении структурных особенностей молекул в виде бинарных векторов. Они особенно полезны для задач **поиска структурно похожих молекул** и часто используются в моделях QSAR/QSPR благодаря своей способности захватывать локальные химические окружения.
  * **RDKit Descriptors**: Предоставляют набор **стандартных и широко используемых** дескрипторов, таких как logP, молекулярный вес, количество доноров/акцепторов водородных связей и т.д. Они дополняют другие наборы дескрипторов, предоставляя **быстро вычисляемые и интерпретируемые** физико-химические свойства.

Выбор этих трех типов дескрипторов и отпечатков обеспечивает **комплексное и разнообразное представление** молекулярных структур, что критически важно для построения **надежных предсказательных моделей**.

### 3\. Обучение регрессионной модели машинного обучения

В качестве целевой переменнной был выбран показатель активности в формате PiC50.
Для предсказания активности молекул была обучена модель **CatBoostRegressor**. Эта модель была выбрана благодаря её **высокой производительности, устойчивости к переобучению и способности отбирать признаки**, а также потому, что она показала лучшие результаты в сравнении с другими моделями(сравнвались различные виды градиентного бустинга и случайного леса, нейросети mlp, табличные нейросети). Для обучения CatBoostRegressor была использована комбинация таких наборов признаков как: **Morgan Fingerprints** и **rdkit descriptors**, как наиболее подходящее и эффективное представление молекул для данной задачи. Эти наборы признаков также показали лучшие метрики относительно других. Для повышения устойчивости и эффективности модели, а также устранения избыточности, была проведена обработка признаков по коллинеарности.
Для модели оценивались метрики по кроссвалидации: 
* R2 = 0.72, 
* RMSE =0.72, 
* NMAE = -0.5. 
 
### 4\. Генерация новых молекул с использованием Reinvent 4

Для генерации новых молекул с оптимизированной активностью была использована модель Reinvent4, архитектура которой основана на рекуррентных нейронных сетях (RNN) для генерации SMILES-строк.

Процесс генерации проходил в режиме дообучения с подкреплением (RL). В этом итеративном цикле Reinvent4 генерировала молекулы, а предварительно обученная модель CatBoostRegressor (см. раздел 3) служила функцией награды (reward function). Она предсказывала биологическую активность сгенерированных молекул. На основе этих предсказаний Reinvent4 корректировала свои параметры, чтобы целенаправленно увеличивать вероятность генерации химически корректных структур с высокой предсказанной активностью. Таким образом, CatBoostRegressor направляла генеративный процесс, обеспечивая оптимизацию свойств и отбор наиболее перспективных соединений.

### 5\. Фильтрация сгенерированных молекул

 Главный критерий отбора был показатель активности piC50. порог по активности pIC50 ≥ 6.7 был выбран потому, что он позволяет сфокусироваться на генерации молекул с высокой предсказанной активностью, учитывая возможную ошибку. Установка порога выше 6 уменьшает вероятность ошибочно предсказанных активностей.
Сгенерированные молекулы также проходят строгую фильтрацию по следующим критериям для отбора наиболее перспективных кандидатов:

  * **`qed` (Quantitative Estimation of Drug-likeness) \> 0.7**: Отбираются молекулы с высокой степенью **лекарственного подобия**, что указывает на их потенциальную пригодность в качестве лекарств.
  * **`sa` (Synthetic Accessibility) в диапазоне от 2 до 6**: Молекулы должны иметь **умеренную синтетическую доступность**, т.е. быть не слишком простыми (что может указывать на отсутствие специфичности) и не слишком сложными (что затруднит синтез).
  * **`bbb` (Blood-Brain Barrier permeability)**: Отбираются молекулы, способные **проникать через гематоэнцефалический барьер**, что критически важно для лечения заболеваний ЦНС, таких как болезнь Альцгеймера.
  * **`tox_free` (отсутствие токсичности)**: Молекулы должны быть **нетоксичными**, что является обязательным требованием для лекарственных препаратов.
  * **`lip` (Lipinski's Rule of Five violations) \<= 1**: Молекулы должны соответствовать **правилам Липинского**, что повышает вероятность их хорошей абсорбции и биодоступности.
  * **`carc` (отсутствие канцерогенности)**: Молекулы должны быть **неканцерогенными**, что является фундаментальным требованием безопасности.

Эта система фильтрации гарантирует, что только **качественные, потенциально эффективные и безопасные** молекулы будут отобраны для дальнейшего анализа.


## Контакты

* @SireX2106

* @philareth

* @sunraysu

* @matveiss

* @readKavafisListenFredAgain

